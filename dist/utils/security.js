const ENCRYPTION_KEY="a1b2c3d4e5f6g7h8",RATE_LIMIT={WINDOW_MS:1e3,MAX_REQUESTS:10,requests:new Map,intervalId:null,isAllowed:function(e){const t=Date.now(),n=t-this.WINDOW_MS;this.requests.has(e)||this.requests.set(e,[]);const s=this.requests.get(e).filter((e=>e>n));return this.requests.set(e,s),!(s.length>=this.MAX_REQUESTS)&&(s.push(t),!0)},cleanup:function(){const e=Date.now();for(const[t,n]of this.requests.entries()){const s=n.filter((t=>e-t<2*this.WINDOW_MS));0===s.length?this.requests.delete(t):this.requests.set(t,s)}},reset:function(){this.requests.clear(),this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}},isTestEnvironment="undefined"!=typeof process&&("test"===process.env?.NODE_ENV||void 0!==process.env?.JEST_WORKER_ID);isTestEnvironment||"undefined"==typeof window||RATE_LIMIT.intervalId||(RATE_LIMIT.intervalId=setInterval((()=>RATE_LIMIT.cleanup()),2*RATE_LIMIT.WINDOW_MS));const cleanupRateLimiter=()=>{RATE_LIMIT.intervalId&&(clearInterval(RATE_LIMIT.intervalId),RATE_LIMIT.intervalId=null),RATE_LIMIT.requests.clear()};function isValidUrl(e){try{const t=new URL(e);return["http:","https:"].includes(t.protocol)}catch(e){return!1}}function sanitizeInput(e){return null==e?"":"string"!=typeof e?String(e):e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}export{RATE_LIMIT,cleanupRateLimiter,isValidUrl,sanitizeInput};